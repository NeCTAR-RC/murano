#  Licensed under the Apache License, Version 2.0 (the "License"); you may
#  not use this file except in compliance with the License. You may obtain
#  a copy of the License at
#
#       http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
#  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
#  License for the specific language governing permissions and limitations
#  under the License.

Namespaces:
  =: io.murano.resources
  std: io.murano


Name: RecordSet
Extends: std:CloudResource


Properties:
  zone:
    Contract: $.string().notNull()
  name:
    Contract: $.string().notNull()
  type:
    Contract: $.string().notNull().check($ in list(A, CNAME))
    Default: A


Methods:
  create:
    Arguments:
      - records:
          Contract: [$.string().notNull()]
    Body:
      - $region: $.getRegion()
      - $resourceName: format('recordset-{0}', $.name)
      - $recordSetTemplate:
          resources:
            $resourceName:
              type: 'OS::Designate::RecordSet'
              properties:
                zone: $.zone
                name: $.name
                type: $.type
                records: $records
      - $template: $region.stack.current()
      - $template: $template.mergeWith($recordSetTemplate)
      - $region.stack.setTemplate($template)
      - $region.stack.push()
      - Return: $template
